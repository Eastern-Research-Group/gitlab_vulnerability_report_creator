/**
 * @typedef DastResultData
 * @type {object}
 * @property {Scan} scan - Scan result metadata
 * @property {Vulnerability[]} vulnerabilities - Descriptions of discovered Vulnerabilities
 */

/**
 * @typedef Endpoint
 * @property {string} url - URL of the endpoint
 * @property {string} scannerId - Scanner identifier
 */

/**
 * @typedef Identifier
 * @type {object}
 * @property {string} name - Common name for the vulnerability
 * @property {string} type - Type of identifier
 * @property {string} url - Link to a description of the vulnerability
 */

/**
 * @typedef Instance
 * @type {object}
 * @property {ScanRequest} request - ScanRequest metadata
 * @property {ScanResponse} response - Response metadata
 * @property {string} summary - Summary of the finding
 */

/**
 * @typedef ParsedData
 * @type {object}
 * @property {Endpoint[]} endpoints - List of scanned endpoints
 * @property {{ [key: string]: number }} kpis - Key performance indicators
 * @property {ScanMetadata[]} scans - List of scanners used
 * @property {Vulnerability[]} vulnerabilities - List of discovered vulnerabilities
 */

/**
 * @typedef ScanRequest
 * @type {object}
 * @property {string} method - HTTP method of the request
 * @property {ScanResponse} url - URL of the request
 */

/**
 * @typedef ScanResponse
 * @type {object}
 * @property {string} reason_phrase - Reason phrase for the response status code
 * @property {number} status_code - HTTP status code of the response
 * @property {string} body - Body of the response
 */

/**
 * @typedef Scan
 * @type {object}
 * @property {string} end_time - Time when the scan ended
 * @property {Array<{ url: string }>} scanned_resources - List of scanned endpoints
 * @property {Scanner} scanner - Scanner metadata
 * @property {string} start_time - Time when the scan started
 * @property {string} status - Status of the scan
 */

/**
 * @typedef {Scanner & { start_time: string, end_time: string }} ScanMetadata
 */

/**
 * @typedef Scanner
 * @type {object}
 * @property {string} id - Unique identifier for the scanner
 * @property {string} name - Common name for the scanner
 * @property {string} url - URL for the scanner's homepage
 * @property {string} version - Version of the scanner
 */

/**
 * @typedef {{ [key: string]: { id: string, instances: Instance[] }}} VulnerabilityMap
 */

/**
 * @typedef {VulnerabilityMetadata & { evidence: Instance }} Vulnerability
 */

/**
 * @typedef VulnerabilityMetadata
 * @type {object}
 * @property {string} description - Detailed description of the vulnerability
 * @property {string} discovered_at - Time during the scan when the vulnerability was discovered
 * @property {string} id - Unique identifier for the vulnerability
 * @property {Identifier[]} identifiers - Common descriptions or CWE categories of the vulnerability
 * @property {string} severity - Severity level of the vulnerability
 */
